@startuml
!pragma teoz true
title Robustness - UC1: Reset Password
hide footbox

skinparam shadowing false
skinparam roundcorner 12
skinparam dpi 200
skinparam maxMessageSize 30
skinparam sequenceMessageAlign center
skinparam responseMessageBelowArrow true
skinparam ParticipantPadding 18

actor "Registered User" as User

box "NGO Management System"
boundary "Forgot Password\nUI" as UI
control "Security\nManager" as SecMgr
entity "User\nDatabase" as UserDB
control "Notification\nService" as Notif
end box

actor "Email Provider" as Email

User -> UI : requestReset(email)
UI -> SecMgr : validateRequest(email)

SecMgr -> UserDB : findUserByEmail()
UserDB --> SecMgr : return(userExists)

alt User Found
    SecMgr -> SecMgr : generateOTP()
    SecMgr -> UserDB : saveOTP(hash)
    SecMgr -> Notif : triggerEmail(otp)
    Notif -> Email : send(email, otp)
    Notif --> SecMgr : status(sent)
end

SecMgr --> UI : result(showOtpInput)
UI --> User : promptForOTP()
@enduml